#include <inttypes.h>
#include <stddef.h>

// -------------------
// Simple BPbis bundle
// -------------------
//
// A CBOR-encoded BPbis bundle with all extension blocks specified in BPbis.
const uint8_t cbor_simple_bundle[] = {
	0x9f, // CBOR indefinite array

	// Primary block
	//
	// [
	//   7,                # Protocol version
	//   2180,             # Bundle Processing Flags:
	//                     #   - REPORT_DELIVERY
	//                     #   - CONTAINS_MANIFEST
	//                     #   - MUST_NOT_BE_FRAGMENTED
	//   0,                # CRC Type (None)
	//   [1, "GS2"],       # Destination EID "dtn:GS2"
	//   [2, [243, 350]],  # Source EID "ipn:243.350"
	//   [1, 0],           # Report-to EID "dtn:none"
	//   [0, 0],           # Creation Timestamp
	//   86400             # Lifetime
	// ]
	0x88, 0x07, 0x19, 0x08, 0x84, 0x00, 0x82, 0x01, 0x63, 0x47, 0x53, 0x32,
	0x82, 0x02, 0x82, 0x18, 0xf3, 0x19, 0x01, 0x5e, 0x82, 0x01, 0x00, 0x82,
	0x00, 0x00, 0x1a, 0x00, 0x01, 0x51, 0x80,

	// Previous Node Block
	//
	// [7, 2, 0, 0, 6, [1, "GS4"]]
	0x86, 0x07, 0x02, 0x00, 0x00, 0x06, 0x82,
	0x01, 0x63, 0x47, 0x53, 0x34,

	// Hop Count Block
	//
	// [9, 3, 0, 0, 4, [30, 0]]
	0x86, 0x09, 0x03, 0x00, 0x00, 0x04, 0x82,
	0x18, 0x1e, 0x00,

	// Bundle Age Block
	//
	// [8, 4, 0, 2, 1144190083, 1, 0]
	0x86, 0x08, 0x04, 0x00, 0x00, 0x01, 0x00,

	// Payload Block
	//
	// [1, 0, 0, 2, 269956074, 13, b'Hello world!']
	0x86, 0x01, 0x00, 0x00, 0x00, 0x0d, 0x4c,
	0x48, 0x65, 0x6c, 0x6c, 0x6f, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21,

	0xff, // CBOR "STOP"
};
const size_t len_simple_bundle = sizeof(cbor_simple_bundle);

// ------------
// CRC 16 AX.25
// ------------
//
// Bundle with CRC-16 checksum for the primary block
//
//   - no bundle processing flags
//   - no extension blocks
//   - payload block with empty byte string and no block processing flags
//
// CBOR structure:
//   [
//     [7, 0, 1, [1, "GS2"], [1, 0], [1, 0], [0, 0], 86400, b"\x71\x23"],
//     [1, 0, 0, 0, 1, b""]
//   ]
const uint8_t cbor_crc16_primary_block[] = {
	0x9f, 0x89, 0x07, 0x00, 0x01, 0x82, 0x01, 0x63, 0x47, 0x53, 0x32, 0x82,
	0x01, 0x00, 0x82, 0x01, 0x00, 0x82, 0x00, 0x00, 0x1a, 0x00, 0x01, 0x51,
	0x80, 0x42, 0x71, 0x23, 0x86, 0x01, 0x00, 0x00, 0x00, 0x01, 0x40, 0xff,
};
const size_t len_crc16_primary_block = sizeof(cbor_crc16_primary_block);

// Bundle with CRC-16 checksum for the payload block
//
//   - no bundle processing flags
//   - no extension blocks
//   - payload block with "Hello world" byte string and CRC 16 checksum and no
//     block processing flags
//
// CBOR structure:
//   [
//     [7, 0, 0, [1, "GS2"], [1, 0], [1, 0], [0, 0], 86400],
//     [1, 0, 0, 1, 12, b"Hello world!", b"\x87\x8e"]
//   ]
const uint8_t cbor_crc16_payload_block[] = {
	0x9f, 0x88, 0x07, 0x00, 0x00, 0x82, 0x01, 0x63, 0x47, 0x53, 0x32, 0x82,
	0x01, 0x00, 0x82, 0x01, 0x00, 0x82, 0x00, 0x00, 0x1a, 0x00, 0x01, 0x51,
	0x80, 0x87, 0x01, 0x00, 0x00, 0x01, 0x0d, 0x4c, 0x48, 0x65, 0x6c, 0x6c,
	0x6f, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21, 0x42, 0x87, 0x8e, 0xff,
};
const size_t len_crc16_payload_block = sizeof(cbor_crc16_payload_block);


// ----------------------------
// CRC 32 Ethernet Verification
// ----------------------------
//
// Bundle with CRC-32 checksum for the primary block
//
//   - no bundle processing flags
//   - no extension blocks
//   - payload block with empty byte string and no block processing flags
//
// CBOR structure:
//   [
//     [
//       7, 0, 2, [1, "GS2"], [1, 0], [1, 0], [0, 0], 86400,
//       b"\xc5\x55\xfd\x3b"
//     ],
//     [1, 0, 0, 0, 1, b""]
//   ]
const uint8_t cbor_crc32_primary_block[] = {
	0x9f, 0x89, 0x07, 0x00, 0x02, 0x82, 0x01, 0x63, 0x47, 0x53, 0x32, 0x82,
	0x01, 0x00, 0x82, 0x01, 0x00, 0x82, 0x00, 0x00, 0x1a, 0x00, 0x01, 0x51,
	0x80, 0x44, 0xc5, 0x55, 0xfd, 0x3b, 0x86, 0x01, 0x00, 0x00, 0x00, 0x01,
	0x40, 0xff,
};

const size_t len_crc32_primary_block = sizeof(cbor_crc32_primary_block);

// Bundle with CRC-32 checksum for the payload block
//
//   - no bundle processing flags
//   - no extension blocks
//   - payload block with "Hello world" byte string and CRC 32 checksum and no
//     block processing flags
//
// CBOR structure:
//   [
//     [7, 0, 0, [1, "GS2"], [1, 0], [1, 0], [0, 0], 86400],
//     [1, 0, 0, 2, 13, b"Hello world!", b"\xc7\x03\x57\x9d"]
//   ]
const uint8_t cbor_crc32_payload_block[] = {
	0x9f, 0x88, 0x07, 0x00, 0x00, 0x82, 0x01, 0x63, 0x47, 0x53, 0x32, 0x82,
	0x01, 0x00, 0x82, 0x01, 0x00, 0x82, 0x00, 0x00, 0x1a, 0x00, 0x01, 0x51,
	0x80, 0x87, 0x01, 0x00, 0x00, 0x02, 0x0d, 0x4c, 0x48, 0x65, 0x6c, 0x6c,
	0x6f, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21, 0x44, 0xc7, 0x03, 0x57,
	0x9d, 0xff,
};

const size_t len_crc32_payload_block = sizeof(cbor_crc32_payload_block);

// Bundle with invalid CRC-16 X.25 checksum for the primary block
//
//   - no bundle processing flags
//   - no extension blocks
//   - payload block with empty byte string and no block processing flags
//
// CBOR structure:
//   [
//     [7, 0, 1, [1, "GS2"], [1, 0], [1, 0], [0, 0], 86400, b"\x00\x00"],
//     [1, 0, 0, 0, 1, b""]
//   ]
const uint8_t cbor_invalid_crc16[] = {
	0x9f, 0x89, 0x07, 0x00, 0x01, 0x82, 0x01, 0x63, 0x47, 0x53, 0x32, 0x82,
	0x01, 0x00, 0x82, 0x01, 0x00, 0x82, 0x00, 0x00, 0x1a, 0x00, 0x01, 0x51,
	0x80, 0x42, 0x00, 0x00, 0x86, 0x01, 0x00, 0x00, 0x00, 0x01, 0x40, 0xff,
};
const size_t len_invalid_crc16 = sizeof(cbor_invalid_crc16);
